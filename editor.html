---
layout: default
title: Editing the file
header: false
full: true
---

<form
    class="flex flex-col gap-6 items-center"
    id="editor-form"
    x-data="editor"
    x-on:submit.prevent="save"
    x-on:attributes-updated="updateAttributes"
>
    <header class="header">
        <div class="header-buttons header-buttons-start">
            <a
                href="reprose:browse"
                class="button"
                x-html="`${icons.open} <span class='hidden lg:block'>Open</span>`"
            ></a>
        </div>

        <div class="header-buttons header-buttons-end">
            <a
                href="reprose:delete"
                class="button"
                x-html="`${icons.trash} <span class='hidden lg:block'>Delete</span>`"
                x-show="!loading && !isNotExists()"
            ></a>
            <button
                class="button button-primary"
                x-html="saving ? icons.spinner : `${icons.save} <span class='hidden lg:block'>Save</span>`"
                x-bind:disabled="loading || saving"
                title="Save"
            ></button>
        </div>
    </header>

    <template x-if="!loading">
        <ul class="kvlist">
            <li class="kvlist-item">
                <input
                    type="text"
                    class="kvlist-input kvlist-input-key"
                    value="filename"
                    readonly
                />
                <input
                    type="text"
                    name="filename"
                    class="kvlist-input kvlist-input-value"
                    required
                    x-model:value="filename"
                />
            </li>
        </ul>
    </template>

    <template x-if="!loading">
        <ul class="kvlist">
            <template x-for="field in fields">
                <li class="kvlist-item">
                    <input
                        type="text"
                        name="attributes[key][]"
                        class="kvlist-input kvlist-input-key"
                        x-bind:value="field.name"
                        x-on:change="$dispatch('attributes-updated')"
                    />
                    <template x-if="field.type === 'text'">
                        <input
                            type="text"
                            name="attributes[value][]"
                            class="kvlist-input kvlist-input-value"
                            x-bind:value="field.value"
                            x-on:input="$dispatch('attributes-updated')"
                        />
                    </template>
                    <template x-if="field.type === 'multiline'">
                        <textarea
                            name="attributes[value][]"
                            class="kvlist-input kvlist-input-value"
                            x-text="field.value"
                            x-data
                            x-autosize
                            x-on:input="$dispatch('attributes-updated')"
                        ></textarea>
                    </template>
                    <template x-if="field.type === 'datetime'">
                        <input
                            type="datetime-local"
                            name="attributes[value][]"
                            class="kvlist-input kvlist-input-value"
                            x-bind:value="field.value"
                            x-on:input="$dispatch('attributes-updated')"
                        ></input>
                    </template>
                    <template x-if="field.type === 'select'">
                        <input
                            type="text"
                            name="attributes[value][]"
                            class="kvlist-input kvlist-input-value"
                            x-bind:value="field.value"
                            x-on:awesomplete-selectcomplete="$dispatch('attributes-updated')"
                            x-data="autocomplete({ type: 'select', values: field.values })"
                        />
                    </template>
                    <template x-if="field.type === 'multiselect'">
                        <input
                            type="text"
                            name="attributes[value][]"
                            class="kvlist-input kvlist-input-value"
                            x-bind:value="field.value"
                            x-on:awesomplete-selectcomplete="$dispatch('attributes-updated')"
                            x-data="autocomplete({ type: 'multiselect', values: field.values })"
                        />
                    </template>
                </li>
            </template>
            <li class="kvlist-item">
                <button
                    class="kvlist-add"
                    type="button"
                    x-html="`${icons.plus} Add`"
                    x-on:click="addAttribute"
                ></button>
            </li>
        </ul>
    </template>

    <template x-if="!loading">
        <textarea
            x-ref="input"
            class="bg-transparent resize-none pointer-events-none"
        ></textarea>
    </template>

    <div x-show="loading" class="loading" x-html="icons.spinner"></div>
</form>
